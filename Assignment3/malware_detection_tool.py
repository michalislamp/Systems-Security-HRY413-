#!/usr/bin/env python3

import argparse
import os
import taskC
import taskB

def main():
    """
    Main function to run the malware detection tool.
    Handles command-line arguments and switches between real-time monitoring and one-time scanning.
    """
    parser = argparse.ArgumentParser(description="Malware Detection Tool")
    parser.add_argument("-d", "--directory", required=True, help="Name of the directory to scan.")
    parser.add_argument("-s", "--signature", required=True, help="Path to the malware signature database.")
    parser.add_argument("-o", "--output", required=True, help="File to save a report of infected files.")
    parser.add_argument("-r", "--realtime", action="store_true", help="Run in real-time mode to monitor the directory.")
    
    args = parser.parse_args()
    
    # Validate the signature file
    if not os.path.isfile(args.signature):
        print(f"Error: The signature file {args.signature} is not accessible.")
        return

    # Initialize and start the appropriate mode based on user input
    if args.realtime:
        try:
            taskB.scan_directory(args.directory, args.signature, 'report.log', args.output)
            taskC.real_time(args)
        except Exception as e:
            print(f"An error occurred in real-time monitoring: {str(e)}")
    else:
        try:
            taskB.scan_directory(args.directory, args.signature, 'report.log', args.output)
        except Exception as e:
            print(f"An error occurred during directory scan: {str(e)}")

if __name__ == "__main__":
    main()


